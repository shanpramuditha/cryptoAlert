{% extends 'base.html.twig' %}

{% block body %}

    <div class="row">
        <div class="col-md-4">
            <p>Percentage for last price notifications</p>
            <input id="percentage" class="form-control" value="10" placeholder="percentage" maxlength="5" style="margin: 10px">
            <div class="checkbox">
                <label><input type="checkbox" id="last-price-notifications">Notifications</label>
            </div>
        </div>

        <div class="col-md-4">
            <p>Percentage for ask/bid notifications</p>
            <input id="ask-bid" class="form-control" value="10" placeholder="ask/bid percentage" maxlength="5" style="margin: 10px">
            <div class="checkbox">
                <label><input type="checkbox" id="ask-bid-notifications">Notifications</label>
            </div>
        </div>
    </div>


    <table id="datatable" class="table table-bordered">
        <thead>
        <tr>
            <th>Currency</th>
            <th>Bitstamp</th>
            <th>Bitstamp</th>
            <th>Bitstamp</th>
            <th>Kraken</th>
            <th>Kraken</th>
            <th>Kraken</th>
            <th>Coinbase</th>
            <th>Coinbase</th>
            <th>Coinbase</th>
            <th>Poloniex</th>
            <th>Poloniex</th>
            <th>Poloniex</th>
            <th>Bitfinex</th>
            <th>Bitfinex</th>
            <th>Bitfinex</th>
            <th>Gemini</th>
            <th>Gemini</th>
            <th>Gemini</th>
            <th>Exmo</th>
            <th>Exmo</th>
            <th>Exmo</th>
            <th>cex</th>
            <th>cex</th>
            <th>cex</th>
            <th>Livecoin</th>
            <th>Livecoin</th>
            <th>Livecoin</th>
            <th>Bitbay</th>
            <th>Bitbay</th>
            <th>Bitbay</th>
            <th>Itbit</th>
            <th>Itbit</th>
            <th>Itbit</th>
            <th>Hitbtc</th>
            <th>Hitbtc</th>
            <th>Hitbtc</th>
            <th>Liqui</th>
            <th>Liqui</th>
            <th>Liqui</th>
            <th>Binance</th>
            <th>Binance</th>
            <th>Binance</th>
            <th>wex</th>
            <th>wex</th>
            <th>wex</th>
            <th>Gate</th>
            <th>Gate</th>
            <th>Gate</th>
            <th>Coinsbank</th>
            <th>Coinsbank</th>
            <th>Coinsbank</th>
            <th>Bitflyer Lightning</th>
            <th>Bitflyer Lightning</th>
            <th>Bitflyer Lightning</th>
            <th>Huobi</th>
            <th>Huobi</th>
            <th>Huobi</th>
            <th>Yobit</th>
            <th>Yobit</th>
            <th>Yobit</th>
            {#<th>Shapeshift</th>#}
            {#<th>Shapeshift</th>#}
            {#<th>Shapeshift</th>#}
            <th>Bittrex</th>
            <th>Bittrex</th>
            <th>Bittrex</th>
            <th>ice3x</th>
            <th>ice3x</th>
            <th>ice3x</th>
            <th>bitcoin.co.id</th>
            <th>bitcoin.co.id</th>
            <th>bitcoin.co.id</th>
            <th>bx.in.th</th>
            <th>bx.in.th</th>
            <th>bx.in.th</th>
        </tr>
        </thead>
        <tbody>
        <tr id="BTCUSD"></tr>
        <tr id="BTCUSDT"></tr>
        <tr id="BTCEUR"></tr>
        <tr id="BTCZAR"></tr>
        <tr id="BTCIDR"></tr>
        <tr id="BTCTHB"></tr>
        <tr id="ETHUSD"></tr>
        <tr id="ETHUSDT"></tr>
        <tr id="ETHEUR"></tr>
        <tr id="ETHBTC"></tr>
        <tr id="ETHLTC"></tr>
        <tr id="ETHZAR"></tr>
        <tr id="ETHIDR"></tr>
        <tr id="ETHTHB"></tr>
        <tr id="BCHUSD"></tr>
        <tr id="BCHUSDT"></tr>
        <tr id="BCHEUR"></tr>
        <tr id="BCHBTC"></tr>
        <tr id="BCHETH"></tr>
        <tr id="BCHZAR"></tr>
        <tr id="BCHIDR"></tr>
        <tr id="BCHTHB"></tr>
        <tr id="ZECUSD"></tr>
        <tr id="ZECUSDT"></tr>
        <tr id="ZECEUR"></tr>
        <tr id="ZECBTC"></tr>
        <tr id="ZECETH"></tr>
        <tr id="BTGUSD"></tr>
        <tr id="BTGUSDT"></tr>
        <tr id="BTGEUR"></tr>
        <tr id="BTGBTC"></tr>
        <tr id="BTGETH"></tr>
        <tr id="BTGIDR"></tr>
        <tr id="DSHUSD"></tr>
        <tr id="DSHUSDT"></tr>
        <tr id="DSHEUR"></tr>
        <tr id="DSHBTC"></tr>
        <tr id="DSHETH"></tr>
        <tr id="DSHTHB"></tr>
        <tr id="ETCUSD"></tr>
        <tr id="ETCUSDT"></tr>
        <tr id="ETCEUR"></tr>
        <tr id="ETCBTC"></tr>
        <tr id="ETCETH"></tr>
        <tr id="ETCIDR"></tr>
        <tr id="LTCUSD"></tr>
        <tr id="LTCUSDT"></tr>
        <tr id="LTCEUR"></tr>
        <tr id="LTCBTC"></tr>
        <tr id="LTCETH"></tr>
        <tr id="LTCZAR"></tr>
        <tr id="LTCIDR"></tr>
        <tr id="LTCTHB"></tr>
        <tr id="XMRUSD"></tr>
        <tr id="XMRUSDT"></tr>
        <tr id="XMREUR"></tr>
        <tr id="XMRBTC"></tr>
        <tr id="XMRETH"></tr>
        <tr id="XRPUSD"></tr>
        <tr id="XRPUSDT"></tr>
        <tr id="XRPEUR"></tr>
        <tr id="XRPBTC"></tr>
        <tr id="XRPETH"></tr>
        <tr id="XRPIDR"></tr>
        <tr id="XRPTHB"></tr>
        <tr id="IOTAUSD"></tr>
        <tr id="IOTAUSDT"></tr>
        <tr id="IOTAEUR"></tr>
        <tr id="IOTABTC"></tr>
        <tr id="IOTAETH"></tr>
        <tr id="EOSUSD"></tr>
        <tr id="EOSUSDT"></tr>
        <tr id="EOSEUR"></tr>
        <tr id="EOSBTC"></tr>
        <tr id="EOSETH"></tr>
        <tr id="ADABTC"></tr>
        <tr id="DOGEBTC"></tr>
        <tr id="DOGEUSD"></tr>
        <tr id="DOGEUSDT"></tr>
        <tr id="USDTUSD"></tr>
        </tbody>
    </table>





{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script>
        {#
            "1"	"Bitstamp"
            "2"	"Kraken"
            "3"	"Coinbase"
            "4"	"Poloniex"
            "5"	"Bitfinex"
            "6"	"Gemini"
            "7"	"Exmo"
            "8"	"CEX"
            "9"	"Livecoin"
            "10"	"Bitbay"
            "11"	"Itbit"
            "12"	"Hitbtc"
            "13"	"Liqui"
            "14"	"Binance"
            "15"	"wex"
            "16"	"Gate"
            "17"	"Coinsbank"
            "18"	"Bitflyer Lightning"
            "19"	"Cryptopia"
            "20"	"Lakebtc"

        #}
        $(function() {
            var prices = new Array(24);
            prices.fill({});
//            setInterval(Bitfinix, 5000);
            setInterval(getData, 15000);
            setInterval(updateTable, 10000);
            setInterval(updateDB, 10000);
            setInterval(notify, 10000);
            setInterval(slowUpdate, 20000);
            var exchanges = ["Bitstamp",
                "Kraken",
                "Coinbase",
                "Poloniex",
                "Bitfinex",
                "Gemini",
                "Exmo",
                "CEX",
                "Liveco in",
                "Bitbay",
                "Itbit",
                "Hitbtc",
                "Liqui",
                "Binance",
                "wex",
                "Gate",
                "Coinsbank",
                "Bitflyer Lightning",
                "Huobi",
                "Yobit",
                "Shapeshift",
                "Bittrex",
                "ice3x",
                "bitcoin.co.id",
                "bx.in.th"
            ];

            function updateDB() {

                $.ajax({type: "GET", url: "{{ url('bitstamp') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('gdax') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('poloniex') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('gemini') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('exmo') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('cex') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('livecoin') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('bitbay') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('itbit') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('hitbtc') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('liqui') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('binance') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('wex') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('gate') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('coinsBank') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('bitflyerLightning') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('huobi') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('yobit') }}", cache: false, success: function(data){  }});
                {#$.ajax({type: "GET", url: "{{ url('shapeshift') }}", cache: false, success: function(data){  }});#}
                $.ajax({type: "GET", url: "{{ url('bittrex') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('ice3x') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('bitcoincoid') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('bxinth') }}", cache: false, success: function(data){  }});

            }

            function compare(first,second,limit) {
//                console.log(first+'        '+second+'    '+limit);
                var diff;
                if(first>second){
                    diff = ((first-second)/second)*100;
                    if(diff != Infinity && diff>limit && diff < 100000){
                        return [first,second,1,diff]
                    }
                }else{
                    diff = ((second-first)/first)*100;
                    if(diff != Infinity && diff>limit){
                        return [first,second,2,diff]
                    }
                }
                return false

            }

            function slowUpdate() {
                $.ajax({type: "GET", url: "{{ url('kraken') }}", cache: false, success: function(data){  }});
                $.ajax({type: "GET", url: "{{ url('bitfinex') }}", cache: false, success: function(data){  }});

            }

            function notify() {
                var currencies = ["BTCUSD","BTCUSDT","BTCEUR","BTCZAR","BTCIDR","BTCTHB",
                    "ETHUSD","ETHUSDT","ETHEUR","ETHBTC","ETHLTC","ETHZAR","ETHIDR","ETHTHB",
                    "BCHUSD","BCHUSDT","BCHEUR","BCHBTC","BCHETH","BCHZAR","BCHIDR","BCHTHB",
                    "ZECUSD","ZECUSDT","ZECEUR","ZECBTC","ZECETH",
                    "BTGUSD","BTGUSDT","BTGEUR","BTGBTC","BTGETH","BTGIDR",
                    "DSHUSD","DSHUSDT","DSHEUR","DSHBTC","DSHETH","DSHTHB",
                    "ETCUSD","ETCUSDT","ETCEUR","ETCBTC","ETCETH","ETCIDR",
                    "LTCUSD","LTCUSDT","LTCEUR","LTCBTC","LTCETH","LTCZAR","LTCIDR","LTCTHB",
                    "XMRUSD","XMRUSDT","XMREUR","XMRBTC","XMRETH",
                    "XRPUSD","XRPUSDT","XRPEUR","XRPBTC","XRPETH","XRPIDR","XRPTHB",
                    "IOTAUSD","IOTAUSDT","IOTAEUR","IOTABTC","IOTAETH",
                    "EOSUSD","EOSUSDT","EOSEUR","EOSBTC","EOSETH",
                    "ADABTC","DOGEBTC","DOGEUSD","DOGEUSDT","USDTUSD",
                ];
                var email = '';
                var askBid = '';
                for(var index = 0; index<currencies.length;index++){
                    for(var i=0; i<prices.length-1; i++) {
//                        console.log(prices[i][currencies[index]]);
                        if(typeof prices[i][currencies[index]] != 'undefined'){
                            var firstPrice = prices[i][currencies[index]][0];
                            var bid = parseFloat(prices[i][currencies[index]][1]);
                            var ask = parseFloat(prices[i][currencies[index]][2]);
                            if($("#ask-bid-notifications").is(':checked')){
                                var rate = (bid/ask) -1;
                                console.log(rate);
                                if(rate > $(parseFloat($('#ask-bid').val()))){
                                    askBid+= '<li>'+(currencies[index])+' - '+bid+':'+ask+' - '+rate+'</li>';
                                }
                            }
                            for(var j=i+1; j<prices.length; j++) {
                                if(typeof prices[j][currencies[index]] != 'undefined'){
                                    var secondPrice = prices[j][currencies[index]][0];
                                    if($("#last-price-notifications").is(':checked')){
                                        var result = compare(firstPrice,secondPrice,parseFloat($('#percentage').val()));
                                        if(result != false){
                                            email+= '<li>'+(currencies[index]+' -   '+exchanges[i]+':'+result[0]+' - '+exchanges[j]+':'+result[1]+' - '+result[3])+'</li>';
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
//                console.log(email);
                if($("#last-price-notifications").is(':checked') && email != ''){
                    email = '<ul>'+email+'</ul>';
                    $.ajax({
                        type: "POST",
                        url: "{{ url('email') }}",
                        data:{'email':email},
                        cache: false,
                        success: function(data){
                            console.log(data);
                        },error:function (xhr, status, error) {
//                            alert(error);
                        }
                    });

                }
                console.log(askBid);
                if($("#ask-bid-notifications").is(':checked') && askBid != ''){
                    email = '<ul>'+email+'</ul>';
                    $.ajax({
                        type: "POST",
                        url: "{{ url('email') }}",
                        data:{'email':askBid},
                        cache: false,
                        success: function(data){
                            console.log(data);
                        },error:function (xhr, status, error) {
//                            alert(error);
                        }
                    });

                }



            }

            function updateTable() {
                var btcusd = '<td>BTCUSD</td>';
                var btcusdt = '<td>BTCUSDT</td>';
                var btceur = '<td>BTCEUR</td>';
                var btczar = '<td>BTCZAR</td>';
                var btcidr = '<td>BTCIDR</td>';
                var btcthb = '<td>BTCTHB</td>';
                var ethusd = '<td>ETHUSD</td>';
                var ethusdt = '<td>ETHUSDT</td>';
                var etheur = '<td>ETHEUR</td>';
                var ethbtc = '<td>ETHBTC</td>';
                var ethltc = '<td>ETHLTC</td>';
                var ethzar = '<td>ETHZAR</td>';
                var ethidr = '<td>ETHIDR</td>';
                var eththb = '<td>ETHTHB</td>';
                var bchusd = '<td>BCHUSD</td>';
                var bchusdt = '<td>BCHUSDT</td>';
                var bcheur = '<td>BCHEUR</td>';
                var bchbtc = '<td>BCHBTC</td>';
                var bcheth = '<td>BCHETH</td>';
                var bchzar = '<td>BCHZAR</td>';
                var bchidr = '<td>BCHIDR</td>';
                var bchthb = '<td>BCHTHB</td>';
                var zecusd = '<td>ZECUSD</td>';
                var zecusdt = '<td>ZECUSDT</td>';
                var zeceur = '<td>ZECEUR</td>';
                var zecbtc = '<td>ZECBTC</td>';
                var zeceth = '<td>ZECETH</td>';
                var btgusd = '<td>BTGUSD</td>';
                var btgusdt = '<td>BTGUSDT</td>';
                var btgeur = '<td>BTGEUR</td>';
                var btgbtc = '<td>BTGBTC</td>';
                var btgeth = '<td>BTGETH</td>';
                var btgidr = '<td>BTGIDR</td>';
                var dshusd = '<td>DASHUSD</td>';
                var dshusdt = '<td>DASHUSDT</td>';
                var dsheur = '<td>DASHEUR</td>';
                var dshbtc = '<td>DASHBTC</td>';
                var dsheth = '<td>DASHETH</td>';
                var dshthb = '<td>DASHTHB</td>';
                var etcusd = '<td>ETCUSD</td>';
                var etcusdt = '<td>ETCUSDT</td>';
                var etceur = '<td>ETCEUR</td>';
                var etcbtc = '<td>ETCBTC</td>';
                var etceth = '<td>ETCETH</td>';
                var etcidr = '<td>ETCIDR</td>';
                var ltcusd = '<td>LTCUSD</td>';
                var ltcusdt = '<td>LTCUSDT</td>';
                var ltceur = '<td>LTCEUR</td>';
                var ltcbtc = '<td>LTCBTC</td>';
                var ltceth = '<td>LTCETH</td>';
                var ltczar = '<td>LTCZAR</td>';
                var ltcidr = '<td>LTCIDR</td>';
                var ltcthb = '<td>LTCTHB</td>';
                var xmrusd = '<td>XMRUSD</td>';
                var xmrusdt = '<td>XMRUSDT</td>';
                var xmreur = '<td>XMREUR</td>';
                var xmrbtc = '<td>XMRBTC</td>';
                var xmreth = '<td>XMRETH</td>';
                var xrpusd = '<td>XRPUSD</td>';
                var xrpusdt = '<td>XRPUSDT</td>';
                var xrpeur = '<td>XRPEUR</td>';
                var xrpbtc = '<td>XRPBTC</td>';
                var xrpeth = '<td>XRPETH</td>';
                var xrpidr = '<td>XRPIDR</td>';
                var xrpthb = '<td>XRPTHB</td>';
                var iotausd = '<td>IOTAUSD</td>';
                var iotausdt = '<td>IOTAUSDT</td>';
                var iotaeur = '<td>IOTAEUR</td>';
                var iotabtc = '<td>IOTABTC</td>';
                var iotaeth = '<td>IOTAETH</td>';
                var eosusd = '<td>EOSUSD</td>';
                var eosusdt = '<td>EOSUSDT</td>';
                var eoseur = '<td>EOSEUR</td>';
                var eosbtc = '<td>EOSBTC</td>';
                var eoseth = '<td>EOSETH</td>';
                var adabtc = '<td>ADABTC</td>';
                var dogebtc = '<td>DOGEBTC</td>';
                var dogeusd = '<td>DOGEUSD</td>';
                var dogeusdt = '<td>DOGEUSDT</td>';
                var usdtusd = '<td>USDTUSD</td>';


                for(var i=0; i<prices.length; i++) {
                    typeof prices[i].BTCUSD != 'undefined' ? btcusd += moneyFormat(prices[i].BTCUSD) : btcusd += "<td></td><td></td><td></td>";
                    typeof prices[i].BTCUSDT != 'undefined' ? btcusdt += moneyFormat(prices[i].BTCUSDT) : btcusdt += "<td></td><td></td><td></td>";
                    typeof prices[i].BTCEUR != 'undefined' ? btceur += moneyFormat(prices[i].BTCEUR) : btceur += "<td></td><td></td><td></td>";
                    typeof prices[i].BTCZAR != 'undefined' ? btczar += moneyFormat(prices[i].BTCZAR) : btczar += "<td></td><td></td><td></td>";
                    typeof prices[i].BTCIDR != 'undefined' ? btcidr += moneyFormat(prices[i].BTCIDR) : btcidr += "<td></td><td></td><td></td>";
                    typeof prices[i].BTCTHB != 'undefined' ? btcthb += moneyFormat(prices[i].BTCTHB) : btcthb += "<td></td><td></td><td></td>";
                    typeof prices[i].ETHUSD != 'undefined' ? ethusd += moneyFormat(prices[i].ETHUSD) : ethusd += "<td></td><td></td><td></td>";
                    typeof prices[i].ETHUSDT != 'undefined' ? ethusdt += moneyFormat(prices[i].ETHUSDT) : ethusdt += "<td></td><td></td><td></td>";
                    typeof prices[i].ETHEUR != 'undefined' ? etheur += moneyFormat(prices[i].ETHEUR) : etheur += "<td></td><td></td><td></td>";
                    typeof prices[i].ETHBTC != 'undefined' ? ethbtc += moneyFormat(prices[i].ETHBTC) : ethbtc += "<td></td><td></td><td></td>";
                    typeof prices[i].ETHLTC != 'undefined' ? ethltc += moneyFormat(prices[i].ETHLTC) : ethltc += "<td></td><td></td><td></td>";
                    typeof prices[i].ETHZAR != 'undefined' ? ethzar += moneyFormat(prices[i].ETHZAR) : ethzar += "<td></td><td></td><td></td>";
                    typeof prices[i].ETHIDR != 'undefined' ? ethidr += moneyFormat(prices[i].ETHIDR) : ethidr += "<td></td><td></td><td></td>";
                    typeof prices[i].ETHTHB != 'undefined' ? eththb += moneyFormat(prices[i].ETHTHB) : eththb += "<td></td><td></td><td></td>";
                    typeof prices[i].BCHUSD != 'undefined' ? bchusd += moneyFormat(prices[i].BCHUSD) : bchusd += "<td></td><td></td><td></td>";
                    typeof prices[i].BCHUSDT != 'undefined' ? bchusdt += moneyFormat(prices[i].BCHUSDT) : bchusdt += "<td></td><td></td><td></td>";
                    typeof prices[i].BCHEUR != 'undefined' ? bcheur += moneyFormat(prices[i].BCHEUR) : bcheur += "<td></td><td></td><td></td>";
                    typeof prices[i].BCHBTC != 'undefined' ? bchbtc += moneyFormat(prices[i].BCHBTC) : bchbtc += "<td></td><td></td><td></td>";
                    typeof prices[i].BCHETH != 'undefined' ? bcheth += moneyFormat(prices[i].BCHETH) : bcheth += "<td></td><td></td><td></td>";
                    typeof prices[i].BCHZAR != 'undefined' ? bchzar += moneyFormat(prices[i].BCHZAR) : bchzar += "<td></td><td></td><td></td>";
                    typeof prices[i].BCHIDR != 'undefined' ? bchidr += moneyFormat(prices[i].BCHIDR) : bchidr += "<td></td><td></td><td></td>";
                    typeof prices[i].BCHTHB != 'undefined' ? bchthb += moneyFormat(prices[i].BCHTHB) : bchthb += "<td></td><td></td><td></td>";
                    typeof prices[i].ZECUSD != 'undefined' ? zecusd += moneyFormat(prices[i].ZECUSD) : zecusd += "<td></td><td></td><td></td>";
                    typeof prices[i].ZECUSDT != 'undefined' ? zecusdt += moneyFormat(prices[i].ZECUSDT) : zecusdt += "<td></td><td></td><td></td>";
                    typeof prices[i].ZECEUR != 'undefined' ? zeceur += moneyFormat(prices[i].ZECEUR) : zeceur += "<td></td><td></td><td></td>";
                    typeof prices[i].ZECBTC != 'undefined' ? zecbtc += moneyFormat(prices[i].ZECBTC) : zecbtc += "<td></td><td></td><td></td>";
                    typeof prices[i].ZECETH != 'undefined' ? zeceth += moneyFormat(prices[i].ZECETH) : zeceth += "<td></td><td></td><td></td>";
                    typeof prices[i].BTGUSD != 'undefined' ? btgusd += moneyFormat(prices[i].BTGUSD) : btgusd += "<td></td><td></td><td></td>";
                    typeof prices[i].BTGUSDT != 'undefined' ? btgusdt += moneyFormat(prices[i].BTGUSDT) : btgusdt += "<td></td><td></td><td></td>";
                    typeof prices[i].BTGEUR != 'undefined' ? btgeur += moneyFormat(prices[i].BTGEUR) : btgeur += "<td></td><td></td><td></td>";
                    typeof prices[i].BTGBTC != 'undefined' ? btgbtc += moneyFormat(prices[i].BTGBTC) : btgbtc += "<td></td><td></td><td></td>";
                    typeof prices[i].BTGETH != 'undefined' ? btgeth += moneyFormat(prices[i].BTGETH) : btgeth += "<td></td><td></td><td></td>";
                    typeof prices[i].BTGIDR != 'undefined' ? btgidr += moneyFormat(prices[i].BTGIDR) : btgidr += "<td></td><td></td><td></td>";
                    typeof prices[i].DSHUSD != 'undefined' ? dshusd += moneyFormat(prices[i].DSHUSD) : dshusd += "<td></td><td></td><td></td>";
                    typeof prices[i].DSHUSDT != 'undefined' ? dshusdt += moneyFormat(prices[i].DSHUSDT) : dshusdt += "<td></td><td></td><td></td>";
                    typeof prices[i].DSHEUR != 'undefined' ? dsheur += moneyFormat(prices[i].DSHEUR) : dsheur += "<td></td><td></td><td></td>";
                    typeof prices[i].DSHBTC != 'undefined' ? dshbtc += moneyFormat(prices[i].DSHBTC) : dshbtc += "<td></td><td></td><td></td>";
                    typeof prices[i].DSHETH != 'undefined' ? dsheth += moneyFormat(prices[i].DSHETH) : dsheth += "<td></td><td></td><td></td>";
                    typeof prices[i].DSHTHB != 'undefined' ? dshthb += moneyFormat(prices[i].DSHTHB) : dshthb += "<td></td><td></td><td></td>";
                    typeof prices[i].ETCUSD != 'undefined' ? etcusd += moneyFormat(prices[i].ETCUSD) : etcusd += "<td></td><td></td><td></td>";
                    typeof prices[i].ETCUSDT != 'undefined' ? etcusdt += moneyFormat(prices[i].ETCUSDT) : etcusdt += "<td></td><td></td><td></td>";
                    typeof prices[i].ETCEUR != 'undefined' ? etceur += moneyFormat(prices[i].ETCEUR) : etceur += "<td></td><td></td><td></td>";
                    typeof prices[i].ETCBTC != 'undefined' ? etcbtc += moneyFormat(prices[i].ETCBTC) : etcbtc += "<td></td><td></td><td></td>";
                    typeof prices[i].ETCETH != 'undefined' ? etceth += moneyFormat(prices[i].ETCETH) : etceth += "<td></td><td></td><td></td>";
                    typeof prices[i].ETCIDR != 'undefined' ? etcidr += moneyFormat(prices[i].ETCIDR) : etcidr += "<td></td><td></td><td></td>";
                    typeof prices[i].LTCUSD != 'undefined' ? ltcusd += moneyFormat(prices[i].LTCUSD): ltcusd += "<td></td><td></td><td></td>";
                    typeof prices[i].LTCUSDT != 'undefined' ? ltcusdt += moneyFormat(prices[i].LTCUSDT) : ltcusdt += "<td></td><td></td><td></td>";
                    typeof prices[i].LTCEUR != 'undefined' ? ltceur += moneyFormat(prices[i].LTCEUR) : ltceur += "<td></td><td></td><td></td>";
                    typeof prices[i].LTCBTC != 'undefined' ? ltcbtc += moneyFormat(prices[i].LTCBTC) : ltcbtc += "<td></td><td></td><td></td>";
                    typeof prices[i].LTCETH != 'undefined' ? ltceth += moneyFormat(prices[i].LTCETH) : ltceth += "<td></td><td></td><td></td>";
                    typeof prices[i].LTCZAR != 'undefined' ? ltczar += moneyFormat(prices[i].LTCZAR) : ltczar += "<td></td><td></td><td></td>";
                    typeof prices[i].LTCIDR != 'undefined' ? ltcidr += moneyFormat(prices[i].LTCIDR) : ltcidr += "<td></td><td></td><td></td>";
                    typeof prices[i].LTCTHB != 'undefined' ? ltcthb += moneyFormat(prices[i].LTCTHB) : ltcthb += "<td></td><td></td><td></td>";
                    typeof prices[i].XMRUSD != 'undefined' ? xmrusd += moneyFormat(prices[i].XMRUSD) : xmrusd += "<td></td><td></td><td></td>";
                    typeof prices[i].XMRUSDT != 'undefined' ? xmrusdt += moneyFormat(prices[i].XMRUSDT) : xmrusdt += "<td></td><td></td><td></td>";
                    typeof prices[i].XMREUR != 'undefined' ? xmreur += moneyFormat(prices[i].XMREUR) : xmreur += "<td></td><td></td><td></td>";
                    typeof prices[i].XMRBTC != 'undefined' ? xmrbtc += moneyFormat(prices[i].XMRBTC) : xmrbtc += "<td></td><td></td><td></td>";
                    typeof prices[i].XMRETH != 'undefined' ? xmreth += moneyFormat(prices[i].XMRETH) : xmreth += "<td></td><td></td><td></td>";
                    typeof prices[i].XRPUSD != 'undefined' ? xrpusd += moneyFormat(prices[i].XRPUSD) : xrpusd += "<td></td><td></td><td></td>";
                    typeof prices[i].XRPUSDT != 'undefined' ? xrpusdt += moneyFormat(prices[i].XRPUSDT) : xrpusdt += "<td></td><td></td><td></td>";
                    typeof prices[i].XRPEUR != 'undefined' ? xrpeur += moneyFormat(prices[i].XRPEUR) : xrpeur += "<td></td><td></td><td></td>";
                    typeof prices[i].XRPBTC != 'undefined' ? xrpbtc += moneyFormat(prices[i].XRPBTC) : xrpbtc += "<td></td><td></td><td></td>";
                    typeof prices[i].XRPETH != 'undefined' ? xrpeth += moneyFormat(prices[i].XRPETH) : xrpeth += "<td></td><td></td><td></td>";
                    typeof prices[i].XRPIDR != 'undefined' ? xrpidr += moneyFormat(prices[i].XRPIDR) : xrpidr += "<td></td><td></td><td></td>";
                    typeof prices[i].XRPTHB != 'undefined' ? xrpthb += moneyFormat(prices[i].XRPTHB) : xrpthb += "<td></td><td></td><td></td>";
                    typeof prices[i].IOTAUSD != 'undefined' ? iotausd += moneyFormat(prices[i].IOTAUSD) : iotausd += "<td></td><td></td><td></td>";
                    typeof prices[i].IOTAUSDT != 'undefined' ? iotausdt += moneyFormat(prices[i].IOTAUSDT) : iotausdt += "<td></td><td></td><td></td>";
                    typeof prices[i].IOTAEUR != 'undefined' ? iotaeur += moneyFormat(prices[i].IOTAEUR) : iotaeur += "<td></td><td></td><td></td>";
                    typeof prices[i].IOTABTC != 'undefined' ? iotabtc += moneyFormat(prices[i].IOTABTC) : iotabtc += "<td></td><td></td><td></td>";
                    typeof prices[i].IOTAETH != 'undefined' ? iotaeth += moneyFormat(prices[i].IOTAETH) : iotaeth += "<td></td><td></td><td></td>";
                    typeof prices[i].EOSUSD != 'undefined' ? eosusd += moneyFormat(prices[i].EOSUSD) : eosusd += "<td></td><td></td><td></td>";
                    typeof prices[i].EOSUSDT != 'undefined' ? eosusdt += moneyFormat(prices[i].EOSUSDT) : eosusdt += "<td></td><td></td><td></td>";
                    typeof prices[i].EOSEUR != 'undefined' ? eoseur += moneyFormat(prices[i].EOSEUR) : eoseur += "<td></td><td></td><td></td>";
                    typeof prices[i].EOSBTC != 'undefined' ? eosbtc += moneyFormat(prices[i].EOSBTC) : eosbtc += "<td></td><td></td><td></td>";
                    typeof prices[i].EOSETH != 'undefined' ? eoseth += moneyFormat(prices[i].EOSETH) : eoseth += "<td></td><td></td><td></td>";
                    typeof prices[i].ADABTC != 'undefined' ? adabtc += moneyFormat(prices[i].ADABTC) : adabtc += "<td></td><td></td><td></td>";
                    typeof prices[i].DOGEBTC != 'undefined' ? dogebtc += moneyFormat(prices[i].DOGEBTC): dogebtc += "<td></td><td></td><td></td>";
                    typeof prices[i].DOGEUSD != 'undefined' ? dogeusd += moneyFormat(prices[i].DOGEUSD) : dogeusd += "<td></td><td></td><td></td>";
                    typeof prices[i].DOGEUSDT != 'undefined' ? dogeusdt += moneyFormat(prices[i].DOGEUSDT) : dogeusdt += "<td></td><td></td><td></td>";
                    typeof prices[i].USDTUSD != 'undefined' ? usdtusd += moneyFormat(prices[i].USDTUSD) : usdtusd += "<td></td><td></td><td></td>";


                }
                $('#BTCUSD').html(btcusd);
                $('#BTCUSDT').html(btcusdt);
                $('#BTCEUR').html(btceur);
                $('#BTCZAR').html(btczar);
                $('#BTCIDR').html(btcidr);
                $('#BTCTHB').html(btcthb);
                $('#ETHUSD').html(ethusd);
                $('#ETHUSDT').html(ethusdt);
                $('#ETHEUR').html(etheur);
                $('#ETHBTC').html(ethbtc);
                $('#ETHLTC').html(ethltc);
                $('#ETHZAR').html(ethzar);
                $('#ETHIDR').html(ethidr);
                $('#ETHTHB').html(eththb);
                $('#BCHUSD').html(bchusd);
                $('#BCHUSDT').html(bchusdt);
                $('#BCHEUR').html(bcheur);
                $('#BCHBTC').html(bchbtc);
                $('#BCHETH').html(bcheth);
                $('#BCHZAR').html(bchzar);
                $('#BCHIDR').html(bchidr);
                $('#BCHTHB').html(bchthb);
                $('#ZECUSD').html(zecusd);
                $('#ZECUSDT').html(zecusdt);
                $('#ZECEUR').html(zeceur);
                $('#ZECBTC').html(zecbtc);
                $('#ZECETH').html(zeceth);
                $('#BTGUSD').html(btgusd);
                $('#BTGUSDT').html(btgusdt);
                $('#BTGEUR').html(btgeur);
                $('#BTGBTC').html(btgbtc);
                $('#BTGETH').html(btgeth);
                $('#BTGIDR').html(btgidr);
                $('#DSHUSD').html(dshusd);
                $('#DSHUSDT').html(dshusdt);
                $('#DSHEUR').html(dsheur);
                $('#DSHBTC').html(dshbtc);
                $('#DSHETH').html(dsheth);
                $('#DSHTHB').html(dshthb);
                $('#ETCUSD').html(etcusd);
                $('#ETCUSDT').html(etcusdt);
                $('#ETCEUR').html(etceur);
                $('#ETCBTC').html(etcbtc);
                $('#ETCETH').html(etceth);
                $('#ETCIDR').html(etcidr);
                $('#LTCUSD').html(ltcusd);
                $('#LTCUSDT').html(ltcusdt);
                $('#LTCEUR').html(ltceur);
                $('#LTCBTC').html(ltcbtc);
                $('#LTCETH').html(ltceth);
                $('#LTCZAR').html(ltczar);
                $('#LTCIDR').html(ltcidr);
                $('#LTCTHB').html(ltcthb);
                $('#XMRUSD').html(xmrusd);
                $('#XMRUSDT').html(xmrusdt);
                $('#XMREUR').html(xmreur);
                $('#XMRBTC').html(xmrbtc);
                $('#XMRETH').html(xmreth);
                $('#XRPUSD').html(xrpusd);
                $('#XRPUSDT').html(xrpusdt);
                $('#XRPEUR').html(xrpeur);
                $('#XRPBTC').html(xrpbtc);
                $('#XRPETH').html(xrpeth);
                $('#XRPIDR').html(xrpidr);
                $('#XRPTHB').html(xrpthb);
                $('#IOTAUSD').html(iotausd);
                $('#IOTAUSDT').html(iotausdt);
                $('#IOTAEUR').html(iotaeur);
                $('#IOTABTC').html(iotabtc);
                $('#IOTAETH').html(iotaeth);
                $('#EOSUSD').html(eosusd);
                $('#EOSUSDT').html(eosusdt);
                $('#EOSEUR').html(eoseur);
                $('#EOSBTC').html(eosbtc);
                $('#EOSETH').html(eoseth);
                $('#ADABTC').html(adabtc);
                $('#DOGEBTC').html(dogebtc);
                $('#DOGEUSD').html(dogeusd);
                $('#DOGEUSDT').html(dogeusdt);
                $('#USDTUSD').html(usdtusd);


                console.log('table updated');
            }

            function getData() {

                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'bitstamp'}) }}", cache: false, success: function(data){ prices[0] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'kraken'}) }}", cache: false, success: function(data){ prices[1] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'gdax'}) }}", cache: false, success: function(data){ prices[2] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'poloniex'}) }}", cache: false, success: function(data){ prices[3] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'bitfinex'}) }}", cache: false, success: function(data){ prices[4] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'gemini'}) }}", cache: false, success: function(data){ prices[5] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'exmo'}) }}", cache: false, success: function(data){ prices[6] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'cex'}) }}", cache: false, success: function(data){ prices[7] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'livecoin'}) }}", cache: false, success: function(data){ prices[8] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'bitbay'}) }}", cache: false, success: function(data){ prices[9] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'itbit'}) }}", cache: false, success: function(data){ prices[10] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'hitbtc'}) }}", cache: false, success: function(data){ prices[11] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'liqui'}) }}", cache: false, success: function(data){ prices[12] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'binance'}) }}", cache: false, success: function(data){ prices[13] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'wex'}) }}", cache: false, success: function(data){ prices[14] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'gate'}) }}", cache: false, success: function(data){ prices[15] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'coinsBank'}) }}", cache: false, success: function(data){ prices[16] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'bitflyerLightning'}) }}", cache: false, success: function(data){ prices[17] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'huobi'}) }}", cache: false, success: function(data){ prices[18] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'yobit'}) }}", cache: false, success: function(data){ prices[19] = data }});
                {#$.ajax({type: "GET", url: "{{ url('data_api',{exchange:'shapeshift'}) }}", cache: false, success: function(data){ prices[20] = data }});#}
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'bittrex'}) }}", cache: false, success: function(data){ prices[20] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'ice3x'}) }}", cache: false, success: function(data){ prices[21] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'bitcoincoid'}) }}", cache: false, success: function(data){ prices[22] = data }});
                $.ajax({type: "GET", url: "{{ url('data_api',{exchange:'bxinth'}) }}", cache: false, success: function(data){ prices[23] = data }});
            }

            function moneyFormat(price) {
                var last = parseFloat(price[0]).toFixed(8);
                var bid = parseFloat(price[1]).toFixed(8);
                var ask = parseFloat(price[2]).toFixed(8);
//                var ii = pieces.length - 3
//                while ((ii-=3) > 0) {
//                    pieces.splice(ii, 0, ',')
//                }
//                return pieces.join('')
                return '<td>'+last+'</td><td>'+bid+'</td><td>'+ask+'</td>'

            }

            function createTable(tableData) {
                var table = document.createElement('table');
                var tableBody = document.createElement('tbody');

                tableData.forEach(function(rowData) {
                    var row = document.createElement('tr');

                    rowData.forEach(function(cellData) {
                        var cell = document.createElement('td');
                        cell.appendChild(document.createTextNode(cellData));
                        row.appendChild(cell);
                    });

                    tableBody.appendChild(row);
                });

                table.appendChild(tableBody);
                document.body.appendChild(table);
            }
        });
    </script>
{% endblock %}

